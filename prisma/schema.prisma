generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["app", "trading"]
}

model game_currency {
  currency_code         String                  @id
  display_name          String
  description           String?
  decimals              Int                     @default(0) @db.SmallInt
  is_active             Boolean                 @default(true)
  created_at            DateTime                @default(now()) @db.Timestamptz(6)
  user_currency_balance user_currency_balance[]

  @@schema("app")
}

model user_currency_balance {
  user_id       String
  currency_code String
  balance       BigInt        @default(0)
  updated_at    DateTime      @default(now()) @db.Timestamptz(6)
  game_currency game_currency @relation(fields: [currency_code], references: [currency_code], onDelete: NoAction, onUpdate: NoAction)
  users         users         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([user_id, currency_code])
  @@schema("app")
}

model users {
  id                    String                  @id
  email                 String                  @unique
  username              String?                 @unique
  role                  String                  @default("user")
  level                 Int                     @default(1)
  xp                    Int                     @default(0)
  created_at            DateTime                @default(now()) @db.Timestamptz(6)
  updated_at            DateTime                @default(now()) @db.Timestamptz(6)
  user_currency_balance user_currency_balance[]

  @@index([email], map: "idx_users_email")
  @@schema("app")
}

model bot_equity {
  bot_id     String
  d          DateTime  @db.Date
  equity     Float
  ret        Float?
  holdings   Json?
  updated_at DateTime? @default(now()) @db.Timestamp(6)

  @@id([bot_id, d])
  @@schema("trading")
}
